{"version":3,"sources":["list.js"],"names":["List","timeago","tmpl","BEFORE","AFTER","$box","$loadMore","api","direction","_$box","$","_$loadMore","_api","_tmpl","_direction","_eventBus","_init","prototype","_load","_registerNextEvents","length","click","_next","get","ok","next","results","trigger","_buildItems","_setNext","cb","on","e","rest","hide","_buildItem","item","result","renderSwitch","bind","items","renderEachSwitch","append","prepend"],"mappings":"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","file":"../../util/list.js","sourcesContent":["import * as timeago from 'timeago'\nimport API from 'util/rest'\nimport * as tmpl from 'util/tmpl'\n\nexport const BEFORE = tmpl.BEFORE\nexport const AFTER = tmpl.AFTER\n\nexport function List ({ $box, $loadMore, tmpl, api, direction = AFTER }) {\n    this._$box = $($box)\n    this._$loadMore = $($loadMore)\n    this._api = api\n    this._tmpl = tmpl\n    this._direction = direction\n    this._eventBus = $({})\n\n    this._init()\n}\n\nList.prototype = {\n\n    _init () {\n        this._load(this._api)\n        this._registerNextEvents()\n    },\n\n    _registerNextEvents () {\n        if (!this._$loadMore.length) return\n        this._$loadMore.click(() => this._next && this._load(this._next))\n    },\n\n    _load (api) {\n        new API(api).get().ok(({ next, results }) => {\n            this._eventBus.trigger('results', [results])\n            this._buildItems(results, this._direction)\n            this._setNext(next)\n        })\n    },\n\n    results (cb) {\n        this._eventBus.on('results', (e, ...rest) => cb(...rest))\n        return this\n    },\n\n    _setNext (next) {\n        this._next = next\n        if (!next) this._$loadMore.hide()\n    },\n\n    _buildItem (item, direction) {\n        let result = tmpl.renderSwitch(direction, this._$box, this._tmpl, item)\n        timeago.bind()\n        return result\n    },\n\n    _buildItems (items, direction) {\n        let result = tmpl.renderEachSwitch(direction, this._$box, this._tmpl, items)\n        timeago.bind()\n    },\n\n    append (item) {\n        return this._buildItem(item, AFTER)\n    },\n\n    prepend (item) {\n        return this._buildItem(item, BEFORE)\n    }\n}\n"]}