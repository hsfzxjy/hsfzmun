{"version":3,"sources":["timeline.js"],"names":["startReal","Date","start_real","valueOf","startFake","start_fake","periods","map","item","duration","getFakeTime","fakeDuration","i","period","length","speed","getTime","$timeDisplay","$","timer","lastTime","timerCallback","fakeTime","fadeOut","clearInterval","fadeIn","find","html","toString","setInterval","click","animate","width","complete","toggleIcon"],"mappings":";;;;;;;;;;;AAIA,QAAMA,YAAY,IAAIC,IAAJ,CAAS,yBAAOC,UAAhB,EAA4BC,OAA5B,EAAlB;AAAA,QAAyDC,YAAY,IAAIH,IAAJ,CAAS,yBAAOI,UAAhB,CAArE;;AAEA,QAAMC,UAAU,yBAAOA,OAAP,CAAeC,GAAf,CAAmB,gBAAQ;AACvCC,aAAKC,QAAL,IAAiB,IAAjB;AACA,eAAOD,IAAP;AACH,KAHe,CAAhB;;AAKA,aAASE,WAAT,GAAwB;AACpB,YAAID,WAAa,IAAIR,IAAJ,EAAD,CAAaE,OAAb,KAAyBH,SAAzC;AAAA,YAAqDW,eAAe,CAApE;;AAEA,YAAIF,WAAW,CAAf,EAAkB,OAAO,WAAP;;AAElB,aAAK,IAAIG,IAAI,CAAR,EAAWC,MAAhB,EAAwBJ,WAAW,CAAX,IAAgBG,IAAIN,QAAQQ,MAApD,EAA4D,EAAEF,CAA9D,EAAiE;AAC7DC,qBAASP,QAAQM,CAAR,CAAT;AACA,gBAAIH,YAAYI,OAAOJ,QAAvB,EAAiC;AAC7BA,4BAAYI,OAAOJ,QAAnB;AACAE,gCAAgBE,OAAOJ,QAAP,GAAkBI,OAAOE,KAAzC;AACH,aAHD,MAGO;AACHJ,gCAAgBF,WAAWI,OAAOE,KAAlC;AACAN,2BAAW,CAAX;AACH;AACJ;;AAED,eAAQA,WAAW,CAAZ,GAAiB,KAAjB,GAAyB,IAAIR,IAAJ,CAASG,UAAUY,OAAV,KAAsBL,YAA/B,CAAhC;AACH;;AAED,QAAMM,eAAeC,EAAE,WAAF,CAArB;AACA,QAAIC,cAAJ;AAAA,QAAWC,WAAW,WAAtB;;AAGA,aAASC,aAAT,GAA0B;AACtB,YAAIC,WAAWZ,aAAf;;AAEA,gBAAQY,QAAR;AACI,iBAAK,WAAL;AACI;AACJ,iBAAK,KAAL;AACIL,6BAAaM,OAAb,CAAqB,IAArB;AACAC,8BAAcL,KAAd;AACA;AACJ;AACI,oBAAIC,aAAa,WAAjB,EAA8BH,aAAaQ,MAAb;AAC9BR,6BAAaS,IAAb,CAAkB,MAAlB,EAA0BC,IAA1B,CAA+BL,SAASM,QAAT,EAA/B;AATR;;AAYAR,mBAAWE,QAAX;AACH;;AAEDH,YAAQU,YAAYR,aAAZ,EAA2B,GAA3B,CAAR;;AAEA;;AAEAJ,iBAAaa,KAAb,CAAmB,YAAM;AACrBb,qBAAaS,IAAb,CAAkB,MAAlB,EAA0BK,OAA1B,CAAkC;AAC9BC,mBAAO;AADuB,SAAlC,EAEG;AACCvB,sBAAU,MADX;AAECwB,sBAAW;AAAA,uBAAMhB,aAAaS,IAAb,CAAkB,GAAlB,EAAuBQ,UAAvB,EAAN;AAAA;AAFZ,SAFH;AAMH,KAPD","file":"../timeline.js","sourcesContent":["import config from 'timeline-config'\nimport 'jquery'\nimport 'util/common'\n\nconst startReal = new Date(config.start_real).valueOf(), startFake = new Date(config.start_fake)\n\nconst periods = config.periods.map(item => {\n    item.duration *= 1000\n    return item\n})\n\nfunction getFakeTime () {\n    let duration = ((new Date()).valueOf() - startReal), fakeDuration = 0\n\n    if (duration < 0) return 'not-start'\n\n    for (let i = 0, period; duration > 0 && i < periods.length; ++i) {\n        period = periods[i]\n        if (duration >= period.duration) {\n            duration -= period.duration\n            fakeDuration += period.duration * period.speed\n        } else {\n            fakeDuration += duration * period.speed\n            duration = 0\n        }\n    }\n\n    return (duration > 0) ? 'end' : new Date(startFake.getTime() + fakeDuration)\n}\n\nconst $timeDisplay = $('.timeline')\nlet timer, lastTime = 'not-start'\n\n\nfunction timerCallback () {\n    let fakeTime = getFakeTime()\n\n    switch (fakeTime) {\n        case 'not-start':\n            break\n        case 'end':\n            $timeDisplay.fadeOut(1000)\n            clearInterval(timer)\n            break\n        default:\n            if (lastTime === 'not-start') $timeDisplay.fadeIn()\n            $timeDisplay.find('span').html(fakeTime.toString())\n    }\n\n    lastTime = fakeTime\n}\n\ntimer = setInterval(timerCallback, 100)\n\n// Animation\n\n$timeDisplay.click(() => {\n    $timeDisplay.find('span').animate({\n        width: 'toggle'\n    }, {\n        duration: 'slow',\n        complete: (() => $timeDisplay.find('i').toggleIcon())\n    })\n})\n"]}